"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44309],{8201:function(t,e,r){r.d(e,{AN:function(){return p},FB:function(){return d},Hf:function(){return b},Pf:function(){return g},Xq:function(){return l},ZQ:function(){return v},_W:function(){return h},bw:function(){return m},dv:function(){return u},h2:function(){return c},nS:function(){return f}});var i=r(26042),n=r(69396),a=r(11987),s=r(59006),o=function(t){var e=t.urlParams,r=void 0===e?{}:e,n=t.queryParams,o=void 0===n?{}:n,u="/cart/".concat(r.isPrimary?s.Yl:s.d7),c=(0,i.Z)({},o);return{url:u,defaultParams:c,formattedUrl:(0,a.format)({pathname:u,query:c})}},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.urlParams,r=void 0===e?{}:e,s=t.queryParams,u=void 0===s?{}:s,c=o({urlParams:r,queryParams:u}),l=(0,i.Z)({},c.defaultParams);return(0,n.Z)((0,i.Z)({},c),{defaultParams:l,formattedUrl:(0,a.format)({pathname:c.url,query:l})})},c=o,l=o,d=function(t){var e=t.urlParams,r=void 0===e?{}:e,n=t.queryParams,s=void 0===n?{}:n,o="/cart/".concat(r.fromCartType,"/to/").concat(r.toCartType),u=(0,i.Z)({},s);return{url:o,defaultParams:u,formattedUrl:(0,a.format)({pathname:o,query:u})}},m=function(t){var e=t.urlParams,r=void 0===e?{}:e,i="/organization/".concat(r.organizationId,"/invitations/").concat(r.status);return{url:i,formattedUrl:(0,a.format)({pathname:i})}},f=function(t){var e=t.urlParams,r="/account/user/".concat((void 0===e?{}:e).id,"/settings");return{url:r,formattedUrl:(0,a.format)({pathname:r})}},v=function(t){var e=t.urlParams,r="/account/user/".concat((void 0===e?{}:e).id,"/settings");return{url:r,formattedUrl:(0,a.format)({pathname:r})}},p=function(t){var e=t.urlParams,r=void 0===e?{}:e,i="/organization/".concat(r.organizationId,"/invitations/").concat(r.invitationId);return{url:i,formattedUrl:(0,a.format)({pathname:i})}},b=function(t){var e=t.urlParams,r="/organization/".concat((void 0===e?{}:e).organizationId,"/invitations");return{url:r,formattedUrl:(0,a.format)({pathname:r})}},h=function(t){var e=t.urlParams,r="/organization/users/".concat((void 0===e?{}:e).id);return{url:r,formattedUrl:(0,a.format)({pathname:r})}},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.queryParams,r=void 0===e?{}:e,o="/cart/".concat(s.Yl,"/quote"),u=(0,n.Z)((0,i.Z)({},r),{exclude_comps:1,expand:"agreements"});return{url:o,defaultParams:u,formattedUrl:(0,a.format)({pathname:o,query:u})}}},11055:function(t,e,r){r.d(e,{n:function(){return c}});var i=r(93056),n=r(36311),a=r(40814),s=r(13925),o=r(55050),u=function(t){var e=t.acc,r=t.totalCostOfItems,n=t.amountRemaining,a=t.totalAmount,s=t.bypassLowBalance;return void 0!==s&&s||(r>n&&(e.hasInsufficientSubscriptionCredits=!0,e.hasLowDebitableBalance=!1,e.insufficientAmount=r-n),!e.hasInsufficientSubscriptionCredits&&n<=a*i.cG&&(e.hasLowDebitableBalance=!0)),e},c=function(t){var e=t.items,r=t.subscriptions,c=t.subscription,l=t.hasWrapperSubscription,d=void 0===l||l;if(e&&e.length){var m={hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:!1,insufficientAmount:0,total:0,totalCreditAmount:0,amountType:i.Zm};return e.reduce((function(t,e){var l,m=e.licenseId,f=e.price,v=(0,a.q)({assets:[e]}),p=c||(0,o.$)({subscriptions:null===(l=(0,s.A)({assetType:v,subscriptions:r}))||void 0===l?void 0:l.subscriptions,licenseName:m,assetType:v})||{},b=(0,n.Vp)(p),h=b.totalAmount,g=b.amountRemaining,y=b.amountType,C=b.amount;t.amountType=y;var I=parseFloat(f),P=parseFloat(t.total)+I;if(t.total+=I,y===i.vh){var T=parseFloat(C),Z=parseFloat(t.totalCreditAmount)+T;return t.totalCreditAmount+=T,u({acc:t,totalCostOfItems:Z,amountRemaining:g,totalAmount:h,bypassLowBalance:!d})}return u({acc:t,totalCostOfItems:P,amountRemaining:g,totalAmount:h,bypassLowBalance:!d})}),m)}var f=r||{},v=Object.keys(f).find((function(t){return Array.isArray(f[t])&&f[t].length})),p=v&&(0,n.bC)({subscriptions:f[v]||[]})[0]||{},b=(0,n.Vp)(p),h=b.totalAmount,g=b.amountRemaining;return{amountType:b.amountType,hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:g<=h*i.cG,insufficientAmount:null}}},71136:function(t,e,r){r.d(e,{k:function(){return o}});var i=r(93056),n=r(36311),a=r(17806),s=r(11055),o=function(t){var e,r=t.items,o=t.isLoading,u=t.subscription,c=t.subscriptions,l=t.userCapabilities;return o?{}:(u&&(e=u.creditType),c&&c.length>0&&(e=c[0].creditType),(0,n.Kc)({userCapabilities:l})?(0,s.n)({items:r,subscription:u,subscriptions:c,hasWrapperSubscription:(0,n.zF)({userCapabilities:l})}):{amountType:e||i.Zm,hasLowDebitableBalance:!1,hasInsufficientSubscriptionCredits:u&&0===(0,a.I)({subscription:u}),insufficientAmount:null})}},64256:function(t,e,r){r.d(e,{U:function(){return s}});var i=r(93056),n=r(72957),a=r(25192),s=function(t){var e=t.uniqueSubscription;if(!e)return{};var r=e.priceAsAbsolute,s=e.creditCurrency,o=e.product,u=(0,a.q)({subscription:e}),c=null!==s&&void 0!==s?s:null===o||void 0===o?void 0:o.currency;if(!r){var l=e.creditPrice,d=e.creditType,m=void 0===d?i.Zm:d;return{price:"".concat((0,n.lO)({price:l,isUnlimited:u})),priceType:m,currency:c}}var f=r.price,v=r.priceType;return{price:"".concat((0,n.lO)({price:f,isUnlimited:u})),priceType:v,currency:c}}},15599:function(t,e,r){r.d(e,{K:function(){return d}});var i=r(26042),n=r(69396),a=r(10253),s=r(67294),o=r(70056),u=r(98462),c=r(84977),l=r(33340),d=function(){var t=(0,l.yh)().analytics,e=(0,c.Y)().getSearchContext,r=(0,s.useCallback)((function(e){var r=e.cartId,i=(e.items||[]).map((function(t,e){return(0,u.zm)({asset:t,cartId:r,index:e})})),n=i.reduce((function(t,e){return{totalPrice:t.totalPrice+Number(e.price),toBeBilled:t.toBeBilled+1}}),{totalPrice:0,toBeBilled:0});t.cartViewed({products:i,cartId:r,cartTotal:Math.round(100*n.totalPrice)/100,numItemsBilledToCard:n.toBeBilled,shouldCheckout:n.totalPrice>0,shouldDownload:i.length>0&&0===n.totalPrice})}),[t]);return{productAddedAnalyticsEvent:(0,s.useCallback)((function(r){var i=r.cart,n=r.eventLabel,a=r.gridItems,s=r.items,o=r.licenseId,c=r.licensePrice,l=r.listId,d=r.pageSection;t.productAdded({products:s.map((function(t){return(0,u.bR)({asset:t,cartData:i,getSearchContext:e,gridItems:a,licenseId:o,licensePrice:c,pageSection:d})})),eventLabel:n,list_id:null!==l&&void 0!==l?l:""})}),[t,e]),productRemovedAnalyticsEvent:(0,s.useCallback)((function(r){var s=r.cart,c=r.eventLabel,l=r.gridItems,d=r.items,m=r.listId,f=r.matchingCartItem,v=r.pageSection;if(f){var p=(0,a.Z)(d,1)[0];t.productRemoved((0,n.Z)((0,i.Z)({},(0,u.bR)({asset:p,cartData:s,getSearchContext:e,gridItems:l,pageSection:v})),{price:f.price===o.q9?0:Number(f.price),variant:f.licenseId,eventLabel:c,list_id:null!==m&&void 0!==m?m:""}))}else t.productRemoved({products:d.map((function(t){return(0,u.bR)({asset:t,cartData:s,getSearchContext:e,gridItems:l,pageSection:v})})),eventLabel:c,list_id:null!==m&&void 0!==m?m:""})}),[t,e]),cartViewedAnalyticsEvent:r}}},44309:function(t,e,r){r.d(e,{D9:function(){return N},GH:function(){return M},Z4:function(){return G},gV:function(){return Y},kC:function(){return O}});var i=r(47568),n=r(14924),a=r(26042),s=r(69396),o=r(99534),u=r(10253),c=r(36305),l=r(70655),d=r(11163),m=r(67294),f=r(40821),v=r(8201),p=r(331),b=r(82475),h=r(24899),g=r(70056),y=r(59006),C=r(48588),I=r(27394),P=r(93056),T=r(98462),Z=r(95624),w=r(71578),S=r(72957),A=r(35772),_=r(55050),L=r(64256),k=r(57488),U=r(25192),B=r(71136),R=r(36311),q=r(84977),x=r(15599),z=r(60235),D=r(93636),F=r(75957),E=r(19805),V="Size limit warning",j=function(t){var e,r=t.asset;return r.itemType===g.k4&&!r.sizes&&!(null===(e=r.metadata)||void 0===e?void 0:e.cart.sizes)},N=function(t){var e=t.cartItems,r=void 0===e?[]:e,i=t.subscriptions;return r.filter((function(t){return[g.k4,g.pX,g.j0,g.tn,g.gP,g.cF].includes(t.itemType)})).map((function(t){var e,r,o,u,c,l,d,m,f,v,p,b,y,C,Z,w=function(t){var e=t.item,r=t.subscriptions,i=e.itemType,n=e.metadata,a=(0,S.Qo)({asset:e}),s=null===n||void 0===n?void 0:n.cart.licenseId,o=r.allSubscriptions;switch(i){case g.pX:return(0,A.I)({licenseName:s,subscriptions:o});case g.j0:case g.tn:case g.k4:default:return(0,_.$)({licenseName:s,subscriptions:o,assetType:i,contentTier:a})}}({item:t,subscriptions:i}),B=function(t){var e,r,i=t.item;return(null===(e=i.largeThumb)||void 0===e?void 0:e.url)||(null===(r=i.preview)||void 0===r?void 0:r.url)||i.preview||i.thumb||""}({item:t}),R=(0,L.U)({uniqueSubscription:w}),q=R.price,x=void 0===q?0:q,z=R.priceType,D=void 0===z?P.Zm:z,F=null===(e=t.assets)||void 0===e?void 0:e.find((function(t){return t.assetClass===I.TT})),E=null===(r=t.meta)||void 0===r?void 0:r.search_context;(null===(o=t.metadata)||void 0===o||null===(u=o.cart)||void 0===u?void 0:u.searchContext)&&(E=(0,T.Be)({trackingId:null===(v=t.metadata)||void 0===v||null===(p=v.cart)||void 0===p||null===(b=p.searchContext)||void 0===b?void 0:b.searchTrackingId,searchTerm:null===(y=t.metadata)||void 0===y||null===(C=y.cart)||void 0===C||null===(Z=C.searchContext)||void 0===Z?void 0:Z.searchTerm}));return(0,s.Z)((0,a.Z)((0,s.Z)((0,a.Z)({},t),{id:t.itemId}),[g.k4,g.gP,g.cF].some((function(e){return e===t.itemType}))&&{image:{id:t.itemId,categories:t.categories,description:t.description||t.subhead||"",url:B.replace("-150nw","-260nw"),isEditorial:!!t.isEditorial,isPremium:!!t.isPremium,displays:(0,n.Z)({},h.RA,{height:(null===(c=t.largeThumb)||void 0===c?void 0:c.height)||(null===(l=t.preview)||void 0===l?void 0:l.height),width:(null===(d=t.largeThumb)||void 0===d?void 0:d.width)||(null===(m=t.preview)||void 0===m?void 0:m.width)}),permalink:t.permalink,isIllustration:t.isIllustration,isVector:t.isVector}}),{type:t.itemType,isFootageSelect:t.footageSelect,price:x,priceType:D,waveformPng:t.waveformPng||(null===F||void 0===F?void 0:F.externalUrl),currency:(null===w||void 0===w?void 0:w.creditCurrency)||"",licenseId:(null===(f=t.metadata)||void 0===f?void 0:f.cart.licenseId)||"",subscriptionId:(null===w||void 0===w?void 0:w.id)||"-",hasCreditsRemaining:(0,k.r)({subscription:w}),isUnavailableAsset:j({asset:t}),isUnlimited:(0,U.q)({subscription:w}),isUnavailableSubscription:!w,meta:(0,a.Z)({},E?{search_context:E}:{})})}))},O=function(t){var e=t.isPrimary;return(0,v.dv)({urlParams:{isPrimary:e}}).formattedUrl},M=function(t){var e=t.isPrimary,r=(0,E.B)(),i=(0,z.av)().data;return(0,f.ZP)(r&&i?O({isPrimary:e}):null,(function(t){return F.jm.get(t).then((function(t){var e=t.data;return e&&(0,s.Z)((0,a.Z)({},e),{items:N({cartItems:e.items,subscriptions:i})})}))}))},Y=function(){var t=(0,u.Z)((0,m.useState)({status:"",error:void 0}),2),e=t[0],r=t[1],n=(0,u.Z)((0,m.useState)(!1),2),o=n[0],h=n[1],I=(0,m.useRef)(!1),P=(0,x.K)(),T=P.productAddedAnalyticsEvent,S=P.cartViewedAnalyticsEvent,A=P.productRemovedAnalyticsEvent,_=(0,q.Y)().getSearchContext,L=(0,d.useRouter)(),k=(0,m.useCallback)((function(t){"undefined"===typeof(null===t||void 0===t?void 0:t.cartId)||I.current||(I.current=!0,S(t))}),[I,S]),U=(0,m.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter((function(t){var r=t.id;return-1===e.findIndex((function(t){var e=t.id;return r===e}))}))}),[]),B=(0,m.useCallback)((function(t){var e=t.cartItems,r=void 0===e?[]:e,i=t.itemsToAdd,n=void 0===i?[]:i,o=(0,c.Z)(r);return n.forEach((function(t){var e=(0,Z.rw)({asset:t}),r=o.findIndex((function(r){var i=r.id,n=r.type;return i===t.id&&n===e}));r>-1?o[r]=(0,a.Z)({},t):o.unshift((0,s.Z)((0,a.Z)({},t),{addedTime:new Date}))})),o}),[]),R=(0,m.useCallback)(function(){var t=(0,i.Z)((function(t){var e,r,n,a;return(0,l.__generator)(this,(function(s){return e=t.items,r=t.licenseId,n=t.licenseAsJpeg,a=null===e||void 0===e?void 0:e.map(function(){var t=(0,i.Z)((function(t){var e,i,a,s;return(0,l.__generator)(this,(function(o){switch(o.label){case 0:return e=(0,Z.rw)({asset:t}),i=r||t.licenseId,a=n||t.licenseAsJpeg,[4,(0,w.Oo)({asset:t,licenseName:i})];case 1:return s=o.sent(),[2,{item_id:t.id,item_type:e,metadata:{cart:{license_id:i,license_as_jpeg:a,subscription_id:t.subscriptionId,size:s.content_size,format:s.content_format,sizes:(0,w.rB)({asset:t}),search_context:_(t),source:[g.gP,g.cF].some((function(t){return t===e}))?C._e:""}}}]}}))}));return function(e){return t.apply(this,arguments)}}()),[2,Promise.all(a)]}))}));return function(e){return t.apply(this,arguments)}}(),[_]),z=(0,m.useCallback)(function(){var t=(0,i.Z)((function(t){var e,i,n,o,u,c,d,m,g,C,I,P,Z,w,S,L,k,U,q;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:e=t.cart,i=t.eventLabel,n=t.gridItems,o=t.isPrimary,u=void 0===o||o,c=t.itemsToAdd,d=t.licenseId,m=t.formatType,g=t.licensePrice,C=t.mutateCart,I=t.withOptimisticUpdate,P=void 0===I||I,Z=t.pageSection,w=t.listId,l.label=1;case 1:return l.trys.push([1,4,5,7]),S=c.map((function(t){return(0,s.Z)((0,a.Z)({},t),{meta:(0,a.Z)({search_context:_(t)},t.meta)})})),r({status:"",error:void 0}),h(!1),(L=B({cartItems:e.items,itemsToAdd:S})).length>y.fv?(r({status:p.cM}),h(!0),[2]):(P&&C((function(t){return(0,s.Z)((0,a.Z)({},t),{items:L})}),!1),k=(0,v.Xq)({urlParams:{isPrimary:u}}).formattedUrl,[4,R({items:S,licenseId:d,licenseAsJpeg:m===b._3})]);case 2:return U=l.sent(),[4,F.jm.post(k,U)];case 3:return l.sent(),r({status:p.MR}),u&&S.forEach((function(t){var r=e.items.find((function(e){return e.id===t.id}));r&&d!==r.licenseId&&A({cart:e,eventLabel:i,gridItems:n,items:[t],matchingCartItem:r,pageSection:Z}),T({cart:e,eventLabel:i,gridItems:n,items:[t],licenseId:d,licensePrice:g,pageSection:Z,listId:w})})),[3,7];case 4:return q=l.sent(),r({status:p.cM,error:q}),[3,7];case 5:return[4,(0,f.JG)(O({isPrimary:u}))];case 6:return l.sent(),[7];case 7:return[2]}}))}));return function(e){return t.apply(this,arguments)}}(),[B,R,T,A,_]),D=(0,m.useCallback)(function(){var t=(0,i.Z)((function(t){var e,r,i,n,o,u,d,m,p,b,h,g,y,C,I;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:e=t.cartData,r=t.eventLabel,i=t.gridItems,n=t.isPrimary,o=void 0===n||n,u=t.itemsToRemove,d=void 0===u?[]:u,m=t.mutateCart,p=t.pageSection,b=t.routePathProps,h=t.withOptimisticUpdate,g=void 0===h||h,y=t.mutateCallback,l.label=1;case 1:return l.trys.push([1,3,4,8]),g&&m((function(t){return(0,s.Z)((0,a.Z)({},t),{items:U(t.items,d)})}),!1),C=(0,v.h2)({urlParams:{isPrimary:o}}).formattedUrl,[4,F.jm.delete(C,{data:d.map((function(t){return{item_id:t.id,item_type:(0,Z.rw)({asset:t})}}))})];case 2:return l.sent(),o&&A({cart:e,eventLabel:r,gridItems:i,items:d,pageSection:p}),b&&(I=L).push.apply(I,(0,c.Z)(b)),[3,8];case 3:return l.sent(),[3,8];case 4:return y?(y({isPrimary:o}),[3,7]):[3,5];case 5:return[4,(0,f.JG)(O({isPrimary:o}))];case 6:l.sent(),l.label=7;case 7:return[7];case 8:return[2]}}))}));return function(e){return t.apply(this,arguments)}}(),[L,A,U]),E=(0,m.useCallback)(function(){var t=(0,i.Z)((function(t){var e,i,n,o,u,c,d,m,f,b;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:if(e=t.eventLabel,i=t.itemsToMove,n=t.pageSection,o=t.primaryCart,u=t.savedForLaterCart,c=t.mutatePrimaryCart,d=t.mutateSavedForLaterCart,r({status:"",error:void 0}),h(!1),(m=B({cartItems:u.items,itemsToAdd:i})).length>y.fv)throw r({status:p.cM}),h(!0),new Error(V);return c((function(t){return(0,s.Z)((0,a.Z)({},t),{items:U(t.items,i)})}),!1),d((function(t){return(0,s.Z)((0,a.Z)({},t),{items:m})}),!1),f=(0,v.FB)({urlParams:{fromCartType:y.Yl,toCartType:y.d7}}).formattedUrl,[4,R({items:i})];case 1:return b=l.sent(),[4,F.jm.post(f,b)];case 2:return l.sent(),A({cart:o,eventLabel:e,items:i,pageSection:n}),[2]}}))}));return function(e){return t.apply(this,arguments)}}(),[B,R,A,U]),j=(0,m.useCallback)(function(){var t=(0,i.Z)((function(t){var e,i,n,o,u,c,d;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:if(e=t.itemsToMove,i=t.primaryCart,n=t.mutatePrimaryCart,o=t.mutateSavedForLaterCart,r({status:"",error:void 0}),h(!1),(u=B({cartItems:i.items,itemsToAdd:e})).length>y.fv)throw r({status:p.cM}),h(!0),new Error(V);return o((function(t){return(0,s.Z)((0,a.Z)({},t),{items:U(t.items,e)})}),!1),n((function(t){return(0,s.Z)((0,a.Z)({},t),{items:u})}),!1),c=(0,v.FB)({urlParams:{fromCartType:y.d7,toCartType:y.Yl}}).formattedUrl,[4,R({items:e})];case 1:return d=l.sent(),[4,F.jm.post(c,d)];case 2:return l.sent(),T({cart:i,items:e}),[2]}}))}));return function(e){return t.apply(this,arguments)}}(),[B,R,T,U]);return{triggerCartViewedEvent:k,addCartItems:z,removeCartItems:D,moveToSaveForLater:E,moveToPrimary:j,addToCartStatus:e,setAddToCartStatus:r,isSizeLimitWarning:o}},G=function(t){var e=t.cartItems,r=(0,z.av)().data,i=(0,D.U)(),n=i.isLoading,a=(0,o.Z)(i,["isLoading"]),s=!r||n,u=function(t){var e=t.items;return null===e||void 0===e?void 0:e.some((function(t){return!t.hasCreditsRemaining}))}({items:e}),c=(0,B.k)({items:e,isLoading:s,subscriptions:r,userCapabilities:a}),l=c.amountType,d=c.hasInsufficientSubscriptionCredits,m=c.insufficientAmount,f=c.hasLowDebitableBalance;return{amountType:l,isDebitableUser:(0,R.Kc)({userCapabilities:a}),userCanViewDebitableBalance:(0,R.LQ)({userCapabilities:a}),hasInsufficientCartItemsCredits:u,hasInsufficientSubscriptionCredits:d,insufficientAmount:m,hasLowDebitableBalance:f}}}}]);
//# sourceMappingURL=44309-73fbd8a474a9f29c.js.map